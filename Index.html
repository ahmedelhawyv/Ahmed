<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>CyberCheck — Email & Link Scanner (Animated)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="hero">
    <div class="hero-inner">
      <div class="hero-left">
        <div class="badge-glow" title="CyberCheck — Professional">
          <svg width="44" height="44" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <circle cx="12" cy="12" r="10" fill="white" opacity="0.06"/>
            <path d="M7 10l5 4 5-4" stroke="white" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>

        <div>
          <h1>CyberCheck</h1>
          <p class="hero-sub">فحص احترافي للإيميل والروابط — واجهة نظيفة، تفاعلات سلسة</p>
        </div>
      </div>

      <div class="hero-right">
        <!-- Theme toggle -->
        <div class="theme-toggle" id="themeToggle" role="button" aria-label="Toggle theme">
          <span id="themeIcon">🌙</span>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">

    <!-- EMAIL block -->
    <section class="block">
      <article class="card card--email" id="card-email" aria-hidden="false">
        <div class="card-left">
          <div class="card-icon email-icon" aria-hidden="true">✉️</div>
          <div>
            <div class="kicker">فحص الإيميل</div>
            <h2>تحقق من بنية الإيميل ودومين المُرسل</h2>
          </div>
        </div>
        <div class="card-right">
          <button class="btn primary" onclick="togglePanel('email')">افتح الفحص</button>
        </div>
      </article>

      <div id="panel-email" class="panel panel--email anim-panel" aria-hidden="true">
        <div class="panel-head">
          <h3>فحص الإيميل</h3>
          <button class="close" onclick="togglePanel('email')">×</button>
        </div>
        <div class="panel-body">
          <label>أدخل الإيميل</label>
          <input id="emailInput" type="text" placeholder="name@example.com" />
          <div class="actions">
            <button class="btn primary" onclick="checkEmail()">فحص الآن</button>
            <button class="btn ghost" onclick="clearEmail()">مسح</button>
          </div>
          <div id="emailResult" class="panel-result anim-result" aria-live="polite" hidden></div>
        </div>
      </div>
    </section>

    <!-- LINK block -->
    <section class="block">
      <article class="card card--link" id="card-link" aria-hidden="false">
        <div class="card-left">
          <div class="card-icon link-icon" aria-hidden="true">🔗</div>
          <div>
            <div class="kicker">فحص الرابط</div>
            <h2>تحقق من الروابط ومؤشرات الاحتيال</h2>
          </div>
        </div>
        <div class="card-right">
          <button class="btn primary outline" onclick="togglePanel('link')">افتح الفحص</button>
        </div>
      </article>

      <div id="panel-link" class="panel panel--link anim-panel" aria-hidden="true">
        <div class="panel-head">
          <h3>فحص الرابط</h3>
          <button class="close" onclick="togglePanel('link')">×</button>
        </div>
        <div class="panel-body">
          <label>أدخل الرابط</label>
          <input id="urlInput" type="text" placeholder="https://example.com/path" />
          <div class="actions">
            <button class="btn primary danger" onclick="checkURL()">فحص الآن</button>
            <button class="btn ghost" onclick="clearUrl()">مسح</button>
          </div>
          <div id="urlResult" class="panel-result anim-result" aria-live="polite" hidden></div>
        </div>
      </div>
    </section>

    <footer class="footer-note">© 2025 — CyberCheck — أداة تعليمية</footer>
  </main>

<script>
/* ========== Theme toggle (light/dark) ========== */
const themeKey = 'cybercheck-theme';
const themeToggle = document.getElementById('themeToggle');
const themeIcon = document.getElementById('themeIcon');

function applyTheme(t){
  document.documentElement.setAttribute('data-theme', t);
  localStorage.setItem(themeKey, t);
  themeIcon.textContent = (t === 'dark') ? '☀️' : '🌙';
  // small animation
  themeToggle.classList.add('toggle-anim');
  setTimeout(()=> themeToggle.classList.remove('toggle-anim'), 400);
}

function initTheme(){
  const saved = localStorage.getItem(themeKey) || 'light';
  applyTheme(saved);
}
themeToggle.addEventListener('click', ()=> {
  const cur = document.documentElement.getAttribute('data-theme') || 'light';
  applyTheme(cur === 'light' ? 'dark' : 'light');
});
initTheme();

/* ========== Animated panel open/close ========== */
/* panels have class anim-panel; we control opening with classes .open and .closing */
function togglePanel(which){
  const emailPanel = document.getElementById('panel-email');
  const linkPanel = document.getElementById('panel-link');
  const target = which === 'email' ? emailPanel : linkPanel;

  if(target.classList.contains('open')){
    // start closing animation
    target.classList.remove('open');
    target.classList.add('closing');
    target.addEventListener('animationend', function onEnd(){
      target.classList.remove('closing');
      target.setAttribute('aria-hidden','true');
      target.hidden = true;
      target.removeEventListener('animationend', onEnd);
    });
  } else {
    // hide other
    [emailPanel, linkPanel].forEach(p=>{
      if(p !== target && p.classList.contains('open')){
        p.classList.remove('open');
        p.classList.add('closing');
        p.addEventListener('animationend', function onEnd(){
          p.classList.remove('closing');
          p.setAttribute('aria-hidden','true');
          p.hidden = true;
          p.removeEventListener('animationend', onEnd);
        });
      }
    });
    // show target with animation
    target.hidden = false;
    // ensure reflow before adding class to trigger animation
    void target.offsetWidth;
    target.setAttribute('aria-hidden','false');
    target.classList.add('open');
    // scroll into view smoothly
    setTimeout(()=> target.scrollIntoView({behavior:'smooth', block:'center'}), 160);
  }
}

/* ========== Result renderer with small entry animation ========== */
function renderResult(id, verdict, issues){
  const el = document.getElementById(id);
  el.hidden = false;
  // clear previous animation class
  el.classList.remove('pop');
  // build HTML
  let cls = verdict === 'High Risk' ? 'verdict danger' : verdict === 'Suspicious' ? 'verdict warn' : 'verdict good';
  let html = `<div class="${cls}">${verdict}</div>`;
  if(issues && issues.length){
    html += `<div class="issues-title">المشاكل المكتشفة:</div><ul class="issues">${issues.map(i=>`<li>${i}</li>`).join('')}</ul>`;
  } else {
    html += `<div class="small">لا توجد قضايا واضحة.</div>`;
  }
  el.innerHTML = html;
  // trigger pop animation
  void el.offsetWidth;
  el.classList.add('pop');
}

/* ========== heuristics (same as قبل) ========== */
function checkEmail(){
  const v = document.getElementById('emailInput').value.trim();
  const out = 'emailResult';
  document.getElementById(out).hidden = true;
  if(!v){ alert('ادخل إيميل'); return; }
  const issues = [];
  const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if(!re.test(v)) issues.push('بنية الإيميل غير صحيحة');
  const domain = v.split('@').pop().toLowerCase();
  const common = ['gmail.com','outlook.com','yahoo.com','hotmail.com','edu.eg'];
  if(!common.includes(domain)) issues.push('الايميل غير شائع — تأكد من المصدر');
  if(/(free|win|urgent|verify|update)/i.test(v)) issues.push('يحتوي الإيميل كلمات مريبة');
  let verdict = 'Likely Safe';
  if(issues.length >= 2) verdict = 'High Risk';
  else if(issues.length === 1) verdict = 'Suspicious';
  renderResult(out, verdict, issues);
}

function checkURL(){
  const v = document.getElementById('urlInput').value.trim();
  const out = 'urlResult';
  document.getElementById(out).hidden = true;
  if(!v){ alert('ادخل رابط'); return; }
  const issues = [];
  try{
    const u = new URL(v.startsWith('http')? v : 'http://' + v);
    const host = u.hostname;
    if(/^\d{1,3}(\.\d{1,3}){3}$/.test(host)) issues.push('يستخدم عنوان IP بدل دومين');
    if(v.includes('@')) issues.push('يحتوي الرابط على @');
    if(host.includes('xn--')) issues.push('يحتوي الدومين punycode');
    const low = v.toLowerCase();
    ['verify','account','secure','login','update','confirm','password','bank','paypal','free','bonus'].forEach(k=>{ if(low.includes(k)) issues.push('يحتوي على كلمة مريبة: ' + k); });
    if(v.length > 150) issues.push('طول الرابط مريب جداً');
    ['.tk','.pw','.gq','.cf','.ml'].forEach(t=>{ if(host.endsWith(t)) issues.push('TLD مشبوه: ' + t); });
  } catch(e){
    issues.push('بنية الرابط غير صحيحة');
  }
  let verdict = 'Likely Safe';
  if(issues.length >= 3) verdict = 'High Risk';
  else if(issues.length >= 1) verdict = 'Suspicious';
  renderResult(out, verdict, issues);
}

/* clear helpers */
function clearEmail(){ document.getElementById('emailInput').value=''; document.getElementById('emailResult').hidden = true; }
function clearUrl(){ document.getElementById('urlInput').value=''; document.getElementById('urlResult').hidden = true; }
</script>
</body>
</html>
